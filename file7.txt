# ğŸš¦ PressLight Quick Reference Card

## âš¡ 30-Second Setup
```bash
pip install cityflow torch numpy
python cityflow_complete_setup.py
python test_cityflow.py
python presslight_final_complete.py --train
```

## ğŸ”‘ Key Fixes Applied

| Issue | Before | After | Impact |
|-------|--------|-------|--------|
| **Simulator** | Discrete (5s steps) | CityFlow (1s steps) | +realistic |
| **Epsilon decay** | 0.995 (too fast) | 0.9997 (slow) | +exploration |
| **Training** | 100 episodes | 500 episodes | +convergence |
| **Learning rate** | 0.001 | 0.0005 | +stability |
| **Batch size** | 32 | 64 | +less noise |
| **Buffer size** | 10K | 100K | +diversity |
| **Hidden dim** | 128 | 256 | +capacity |

## ğŸ“Š Expected Performance

```
Method          | Queue  | Improvement
----------------|--------|------------
Fixed-Time      | 12.0   | Baseline
Max-Pressure    |  9.0   | +25%
PressLight      |  5.5   | +45-50% âœ…
```

## ğŸ¯ Critical Hyperparameters

```python
# MUST USE THESE:
EPSILON_START = 1.0
EPSILON_MIN = 0.05      # NOT 0.01!
EPSILON_DECAY = 0.9997  # NOT 0.995!

NUM_EPISODES = 500      # NOT 100!
LEARNING_RATE = 5e-4    # NOT 1e-3!
BATCH_SIZE = 64         # NOT 32!
```

## ğŸ“ˆ Training Timeline

```
Episodes    | Epsilon | Improvement | What's Happening
------------|---------|-------------|------------------
0-100       | 1.0â†’0.8 | 0-10%      | Random exploration
100-300     | 0.8â†’0.3 | 10-30%     | Learning patterns
300-500     | 0.3â†’0.05| 30-50%     | Fine-tuning policy
```

## ğŸ› Quick Troubleshooting

```
Problem              | Solution
---------------------|---------------------------
No improvement       | Check epsilon is decaying slowly
Loss exploding       | Add gradient clipping (10.0)
Out of memory        | Reduce buffer to 50K
Training too slow    | Increase CityFlow threads to 8
Results not matching | Use CityFlow, not simplified sim
```

## ğŸ“ Essential Files

```
cityflow_data/
  â”œâ”€ config.json         # Main config
  â”œâ”€ roadnet_2x1.json    # Road network
  â””â”€ flow_arterial.json  # Traffic demand

models/
  â””â”€ best_agent_*.pt     # Trained models

presslight_final_complete.py  # Main script
```

## âš¡ Quick Commands

```bash
# Train
python presslight_final_complete.py --train --episodes 500

# Evaluate
python presslight_final_complete.py --eval --model models/best_agent_0.pt

# Test CityFlow
python test_cityflow.py

# Generate configs
python cityflow_complete_setup.py
```

## ğŸ¯ Success Criteria

- [ ] Queue length < 6 vehicles
- [ ] 40-50% improvement vs Fixed-Time
- [ ] Training converges by episode 400
- [ ] Epsilon reaches 0.05 at episode 375
- [ ] Loss stabilizes < 0.15

## ğŸ“ Where to Find Help

| Need | Check |
|------|-------|
| Installation | `CITYFLOW_TUTORIAL.txt` |
| Concepts | `cityflow_visual_guide` artifact |
| Code | `presslight_final_complete.py` |
| Hyperparameters | `presslight_complete_guide` artifact |
| Setup | `cityflow_complete_setup.py` |

## ğŸ’¡ Pro Tips

1. **Start small**: Test on 2-intersection network first
2. **Monitor epsilon**: Should decay slowly over 500 episodes
3. **Watch the loss**: Should decrease and stabilize
4. **Save often**: Save model every 50 episodes
5. **Multi-seed**: Train with 3 different seeds
6. **Be patient**: Good results take 300+ episodes

## ğŸ† Success Formula

```
CityFlow 
+ Proper Epsilon Decay (0.9997)
+ Extended Training (500 episodes)
+ Optimized Hyperparameters
+ Double DQN + Dueling
= 40-50% Improvement! âœ¨
```

---

**Print this card and keep it handy during implementation!**